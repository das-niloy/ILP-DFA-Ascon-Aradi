#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <inttypes.h>

typedef uint64_t bit64;
typedef uint8_t bit;

void print_f_table( bit f_table[32][5][2] ){
  for(int j=0; j<32; j++){
    for(int i=0; i<5; i++){
      printf("%d%d\t", f_table[j][i][0],f_table[j][i][1]);
    }
    printf("\n");
  }
}
/* 5 Bit S=box  */
void bit_sbox( bit x[5] ) {
    bit t[5] = { 0 };
    x[0] ^= x[4]; 
    x[4] ^= x[3]; 
    x[2] ^= x[1];
    for (int i = 0; i < 5; i++) {
        t[i] = x[i];
    }
    for (int i = 0; i < 5; i++) {
        t[i] = ~t[i] & 1;
    }
    t[0] &= x[1]; 
    t[1] &= x[2]; 
    t[2] &= x[3]; 
    t[3] &= x[4]; 
    t[4] &= x[0];

    x[0] ^= t[1]; 
    x[1] ^= t[2]; 
    x[2] ^= t[3]; 
    x[3] ^= t[4]; 
    x[4] ^= t[0];

    x[1] ^= x[0]; 
    x[0] ^= x[4]; 
    x[3] ^= x[2]; 
    x[2] = ~x[2] & 1;
}

void pre_computation( bit f_table[32][5][2] ){
  bit x[32][5] = { 
                    {0,0,0,0,0}, {0,0,0,0,1}, {0,0,0,1,0}, {0,0,0,1,1}, {0,0,1,0,0}, {0,0,1,0,1}, {0,0,1,1,0}, {0,0,1,1,1},
                    {0,1,0,0,0}, {0,1,0,0,1}, {0,1,0,1,0}, {0,1,0,1,1}, {0,1,1,0,0}, {0,1,1,0,1}, {0,1,1,1,0}, {0,1,1,1,1},
                    {1,0,0,0,0}, {1,0,0,0,1}, {1,0,0,1,0}, {1,0,0,1,1}, {1,0,1,0,0}, {1,0,1,0,1}, {1,0,1,1,0}, {1,0,1,1,1},
                    {1,1,0,0,0}, {1,1,0,0,1}, {1,1,0,1,0}, {1,1,0,1,1}, {1,1,1,0,0}, {1,1,1,0,1}, {1,1,1,1,0}, {1,1,1,1,1}
                 };

  bit sx[32][5] = { 
                    {0,0,1,0,0}, {0,1,0,1,1}, {1,1,1,1,1}, {1,0,1,0,0}, {1,1,0,1,0}, {1,0,1,0,1}, {0,1,0,0,1}, {0,0,0,1,0},
                    {1,1,0,1,1}, {0,0,1,0,1}, {0,1,0,0,0}, {1,0,0,1,0}, {1,1,1,0,1}, {0,0,0,1,1}, {0,0,1,1,0}, {1,1,1,0,0},
                    {1,1,1,1,0}, {1,0,0,1,1}, {0,0,1,1,1}, {0,1,1,1,0}, {0,0,0,0,0}, {0,1,1,0,1}, {1,0,0,0,1}, {1,1,0,0,0},
                    {1,0,0,0,0}, {0,1,1,0,0}, {0,0,0,0,1}, {1,1,0,0,1}, {1,0,1,1,0}, {0,1,0,1,0}, {0,1,1,1,1}, {1,0,1,1,1}
                  };

  bit delta_x[5][5] = { {1, 0, 0, 0, 0}, {0, 1, 0, 0, 0}, {0, 0, 1, 0, 0}, {0, 0, 0, 1, 0}, {0, 0, 0, 0, 1} };  // Input Difference
  
  for(int i = 0; i < 32; i++){
    for(int j = 0; j < 5; j++){
      bit y[5] = {0};
      bit delta_s[5] ={0};
      for(int m = 0; m < 5; m++){
        y[m] = x[i][m] ^ delta_x[j][m];
      }
      bit_sbox(y);
      for(int m = 0; m < 5; m++){
        delta_s[m] = sx[i][m] ^ y[m];
      }
      f_table[i][j][0] = delta_s[3];
      f_table[i][j][1] = delta_s[4];
    }
  }
}

int main(){
  bit f_table[32][5][2];
  pre_computation(f_table);
  print_f_table(f_table);
}

